import{a as A,b as j,u as z,c as E,d as P}from"./search-form.vue_vue_type_script_setup_true_lang-Hz521IbE.js";import{bm as D,d as $,Q as T,R as V,m as G,n as K,a as H,$ as a,r as L,S as Q,o as U,c as B,w as i,f as n,g as C,t as O,h as e,a8 as W,s as F,v as Z,y as J,B as M,x as X,C as Y,b as ee,ae as q,O as ae,ag as te}from"./index-BztLELzb.js";import{_ as ne}from"./Grid-DDhjb_3_.js";function oe(o){return D({url:"/namespace/list",method:"get",params:o})}function se(o){return D({url:"/namespace",method:"post",data:o})}function le(o){return D({url:"/namespace",method:"put",data:o})}const re=$({name:"NamespaceOperateDrawer",__name:"namespace-operate-drawer",props:T({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:T(["submitted"],["update:visible"]),setup(o,{emit:y}){const r=o,c=y,u=V(o,"visible"),{formRef:m,validate:k,restoreValidation:h}=G(),{defaultRequiredRule:f}=K(),x=H(()=>({add:a("page.namespace.addNamespace"),edit:a("page.namespace.editNamespace")})[r.operateType]),s=L(w());function w(){return{name:"",uniqueId:""}}const I={name:f,uniqueId:{required:!1,pattern:/^[A-Za-z0-9_-]{1,64}$/,trigger:"change",message:a("page.namespace.form.uniqueIdRule")}};function R(){if(r.operateType==="add"){Object.assign(s,w());return}r.operateType==="edit"&&r.rowData&&Object.assign(s,r.rowData)}function S(){u.value=!1}async function _(){var b,l;if(await k(),r.operateType==="add"){const{name:t,uniqueId:p}=s,{error:g}=await se({name:t,uniqueId:p});if(g)return;(b=window.$message)==null||b.success(a("common.addSuccess"))}if(r.operateType==="edit"){const{id:t,name:p,uniqueId:g}=s,{error:v}=await le({id:t,name:p,uniqueId:g});if(v)return;(l=window.$message)==null||l.success(a("common.updateSuccess"))}S(),c("submitted")}return Q(u,()=>{u.value&&(R(),h())}),(b,l)=>{const t=F,p=Z,g=J,v=M,d=X;return U(),B(W,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=N=>u.value=N),title:x.value,onSubmitted:_},{footer:i(()=>[n(d,{size:16},{default:i(()=>[n(v,{onClick:S},{default:i(()=>[C(O(e(a)("common.cancel")),1)]),_:1}),n(v,{type:"primary",onClick:_},{default:i(()=>[C(O(e(a)("common.save")),1)]),_:1})]),_:1})]),default:i(()=>[n(g,{ref_key:"formRef",ref:m,model:s,rules:I},{default:i(()=>[n(p,{label:e(a)("page.namespace.uniqueId"),path:"uniqueId"},{default:i(()=>[n(t,{value:s.uniqueId,"onUpdate:value":l[0]||(l[0]=N=>s.uniqueId=N),disabled:r.operateType==="edit",placeholder:e(a)("page.namespace.form.uniqueId")},null,8,["value","disabled","placeholder"])]),_:1},8,["label"]),n(p,{label:e(a)("page.namespace.name"),path:"name"},{default:i(()=>[n(t,{value:s.name,"onUpdate:value":l[1]||(l[1]=N=>s.name=N),placeholder:e(a)("page.namespace.form.name")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ie=$({name:"NamespaceSearch",__name:"namespace-search",props:{model:{required:!0},modelModifiers:{}},emits:T(["reset","search"],["update:model"]),setup(o,{emit:y}){const r=y,c=V(o,"model");function u(){r("reset")}function m(){r("search")}return(k,h)=>{const f=F,x=A,s=j;return U(),B(s,{model:c.value,onSearch:m,onReset:u},{default:i(()=>[n(x,{span:"24 s:12 m:6",label:e(a)("page.namespace.keyword"),path:"keyword",class:"pr-24px"},{default:i(()=>[n(f,{value:c.value.keyword,"onUpdate:value":h[0]||(h[0]=w=>c.value.keyword=w),placeholder:e(a)("page.namespace.form.keyword")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),de={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function ue(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!te(o)}const fe=$({name:"namespace",__name:"index",setup(o){const y=Y(),{columns:r,columnChecks:c,data:u,getData:m,loading:k,mobilePagination:h,searchParams:f,resetSearchParams:x}=z({apiFn:oe,apiParams:{page:1,size:10,keyword:null},columns:()=>[{key:"name",title:a("page.namespace.name"),align:"left",width:120},{key:"uniqueId",title:a("page.namespace.uniqueId"),align:"left",width:180},{key:"createDt",title:a("page.common.createTime"),align:"left",width:130},{key:"updateDt",title:a("page.common.upadteTime"),align:"left",width:130},{key:"operate",title:a("common.operate"),align:"center",width:64,render:l=>{let t;return n("div",{class:"flex-center gap-8px"},[n(M,{type:"primary",text:!0,ghost:!0,size:"small",onClick:()=>b(l.id)},ue(t=a("common.edit"))?t:{default:()=>[t]})])}}]}),{drawerVisible:s,operateType:w,editingData:I,handleAdd:R,handleEdit:S,checkedRowKeys:_}=E(u,m);function b(l){S(l)}return(l,t)=>{const p=P,g=ne,v=ae;return U(),ee("div",de,[n(ie,{model:e(f),"onUpdate:model":t[0]||(t[0]=d=>q(f)?f.value=d:null),onReset:e(x),onSearch:e(m)},null,8,["model","onReset","onSearch"]),n(v,{title:e(a)("page.namespace.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":i(()=>[n(p,{columns:e(c),"onUpdate:columns":t[1]||(t[1]=d=>q(c)?c.value=d:null),"disabled-delete":e(_).length===0,loading:e(k),"show-delete":!1,onAdd:e(R),onRefresh:e(m)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:i(()=>[n(g,{"checked-row-keys":e(_),"onUpdate:checkedRowKeys":t[2]||(t[2]=d=>q(_)?_.value=d:null),columns:e(r),data:e(u),"flex-height":!e(y).isMobile,"scroll-x":962,loading:e(k),remote:"","row-key":d=>d.id,pagination:e(h),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),n(re,{visible:e(s),"onUpdate:visible":t[3]||(t[3]=d=>q(s)?s.value=d:null),"operate-type":e(w),"row-data":e(I),onSubmitted:e(m)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{fe as default};
