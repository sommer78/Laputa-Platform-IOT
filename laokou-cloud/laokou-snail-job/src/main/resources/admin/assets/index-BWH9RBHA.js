import{a as I,b as M,u as O,c as T,N as z,d as j}from"./search-form.vue_vue_type_script_setup_true_lang-Hz521IbE.js";import{d as N,Q as q,z as A,R as F,o as R,c as G,w as d,f as l,h as a,$ as o,a6 as L,cs as K,C as V,b as E,ae as S,B as y,bp as H,P as x,bq as Q,O as J,ag as X}from"./index-BztLELzb.js";import{f as Y,a as Z,b as ee}from"./workflow-CNPsY-Xm.js";import{_ as te}from"./select-group.vue_vue_type_script_setup_true_lang-DXA2Evh-.js";import{_ as ae}from"./task-batch-status.vue_vue_type_script_setup_true_lang-8L6H3MfM.js";import{_ as oe}from"./Grid-DDhjb_3_.js";import"./group-XSuFGJhJ.js";const le=N({name:"WorkflowBatchSearch",__name:"workflow-batch-search",props:{model:{required:!0},modelModifiers:{}},emits:q(["reset","search"],["update:model"]),setup(p,{emit:_}){const k=_,g=A([]),r=F(p,"model");function B(){k("reset")}function m(){k("search")}async function f(i){const s=await Y({groupName:i});g.value=s.data}return f(""),(i,s)=>{const h=I,w=L,b=M;return R(),G(b,{model:r.value,onSearch:m,onReset:B},{default:d(()=>[l(h,{span:"24 s:12 m:6",label:a(o)("page.workflowBatch.groupName"),path:"groupName",class:"pr-24px"},{default:d(()=>[l(te,{value:r.value.groupName,"onUpdate:value":[s[0]||(s[0]=n=>r.value.groupName=n),f]},null,8,["value"])]),_:1},8,["label"]),l(h,{span:"24 s:12 m:6",label:a(o)("page.workflowBatch.workflowName"),"label-width":100,path:"workflowName",class:"pr-24px"},{default:d(()=>[l(w,{value:r.value.workflowId,"onUpdate:value":s[1]||(s[1]=n=>r.value.workflowId=n),placeholder:a(o)("page.workflowBatch.form.workflowName"),"value-field":"id","label-field":"workflowName",options:g.value,clearable:"",filterable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),l(h,{span:"24 s:12 m:6",label:a(o)("page.workflowBatch.taskBatchStatus"),path:"taskBatchStatus",class:"pr-24px"},{default:d(()=>[l(ae,{value:r.value.taskBatchStatus,"onUpdate:value":s[2]||(s[2]=n=>r.value.taskBatchStatus=n)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),se={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function v(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!X(p)}const me=N({name:"workflow_batch",__name:"index",setup(p){const _=K(),k=V(),g=history.state.workflowId,r=history.state.taskBatchStatus,{columns:B,columnChecks:m,data:f,getData:i,loading:s,mobilePagination:h,searchParams:w,resetSearchParams:b}=O({apiFn:Z,apiParams:{page:1,size:10,workflowId:null,groupName:null,taskBatchStatus:null},searchParams:{workflowId:g,taskBatchStatus:r},columns:()=>[{key:"id",title:o("common.index"),align:"center",width:120,render:e=>{function t(){$(e.id)}return l(y,{text:!0,tag:"a",type:"primary",onClick:t,class:"ws-normal"},{default:()=>[e.id]})}},{key:"workflowName",title:o("page.workflowBatch.workflowName"),align:"left",minWidth:120},{key:"groupName",title:o("page.workflowBatch.groupName"),align:"left",minWidth:120},{key:"executionAt",title:o("page.workflowBatch.executionAt"),align:"left",minWidth:120},{key:"taskBatchStatus",title:o("page.workflowBatch.taskBatchStatus"),align:"left",minWidth:120,render:e=>{if(!e.taskBatchStatus)return null;const t={1:"info",2:"success",3:"success",4:"error",5:"warning",6:"warning"},c=o(H[e.taskBatchStatus]);return l(x,{type:t[e.taskBatchStatus]},v(c)?c:{default:()=>[c]})}},{key:"operationReason",title:o("page.workflowBatch.operationReason"),align:"left",minWidth:120,render:e=>{if(!e.operationReason)return null;const t=o(Q[e.operationReason]);return l(x,{type:"warning"},v(t)?t:{default:()=>[t]})}},{key:"createDt",title:o("page.workflowBatch.createDt"),align:"left",minWidth:120},{key:"operate",title:o("common.operate"),align:"center",width:130,render:e=>l("div",{class:"flex-center gap-8px"},[(e==null?void 0:e.taskBatchStatus)===1||(e==null?void 0:e.taskBatchStatus)===2?l(z,{onPositiveClick:()=>P(e.id)},{default:()=>o("common.confirmStop"),trigger:()=>{let t;return l(y,{type:"error",text:!0,ghost:!0,size:"small"},v(t=o("common.stop"))?t:{default:()=>[t]})}}):""])}]}),{checkedRowKeys:n,onBatchDeleted:W}=T(f,i);async function D(){W()}async function P(e){var c;const{error:t}=await ee(e);t||((c=window.$message)==null||c.success(o("common.executeSuccess")),i())}function $(e){_.push({path:"/workflow/form/batch",query:{id:e}})}return(e,t)=>{const c=j,C=oe,U=J;return R(),E("div",se,[l(le,{model:a(w),"onUpdate:model":t[0]||(t[0]=u=>S(w)?w.value=u:null),onReset:a(b),onSearch:a(i)},null,8,["model","onReset","onSearch"]),l(U,{title:a(o)("page.workflowBatch.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":d(()=>[l(c,{columns:a(m),"onUpdate:columns":t[1]||(t[1]=u=>S(m)?m.value=u:null),"disabled-delete":a(n).length===0,loading:a(s),"show-add":!1,"show-delete":!1,onDelete:D,onRefresh:a(i)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:d(()=>[l(C,{"checked-row-keys":a(n),"onUpdate:checkedRowKeys":t[2]||(t[2]=u=>S(n)?n.value=u:null),columns:a(B),data:a(f),"flex-height":!a(k).isMobile,"scroll-x":962,loading:a(s),remote:"","row-key":u=>u.id,pagination:a(h),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{me as default};
